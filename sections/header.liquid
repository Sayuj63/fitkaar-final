{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    }
  ]
}
{% endschema %}

<header class="site-header" style="background: #fff; padding: 15px 0; border-bottom: 1px solid #e5e5e5; position: sticky; top: 0; z-index: 50;" x-data="{ mobileMenuOpen: false }">
  <div class="container flex justify-between items-center">
    
    <!-- Mobile Hamburger Button -->
    <button type="button" class="md:hidden p-2 -ml-2" @click="mobileMenuOpen = !mobileMenuOpen">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12h18M3 6h18M3 18h18" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <!-- Logo -->
    <div class="logo">
      <a href="/" class="flex items-center">
        {% if section.settings.logo %}
          <img src="{{ section.settings.logo | image_url: width: 150 }}" alt="{{ shop.name }}" width="{{ section.settings.logo.width }}" height="{{ section.settings.logo.height }}">
        {% else %}
          <span class="h2" style="font-family: var(--font-heading); font-size: 24px; color: var(--color-primary);">FITKAAR</span>
        {% endif %}
      </a>
    </div>

    <!-- Navigation (Desktop) -->
    <nav class="hidden md:flex gap-8">
      {% for link in linklists.main-menu.links %}
        <a href="{{ link.url }}" class="text-base hover:text-primary uppercase font-bold" style="color: #000; text-decoration: none;">{{ link.title }}</a>
      {% endfor %}
    </nav>

    <!-- Icons -->
    <div class="header-icons flex gap-4 items-center">
      <a href="/search" class="icon-search">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </a>
      
      <!-- Cart Icon with Alpine.js logic for count -->
      <a href="/cart" class="icon-cart relative" id="cart-icon-bubble">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z" fill="currentColor"/><path d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z" fill="currentColor"/><path d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38755 15.5583C8.75318 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3268 15.8526 20.6925 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        {% if cart.item_count > 0 %}
          <div class="cart-count-bubble" style="background-color: var(--color-secondary); color: white; position: absolute; top: -8px; right: -8px; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold;">
            {{ cart.item_count }}
          </div>
        {% endif %}
      </a>
    </div>
  </div>

  <!-- Mobile Menu Drawer -->
  <div class="fixed inset-0 z-50 flex" x-show="mobileMenuOpen" style="display: none;" 
       x-transition:enter="transition-opacity ease-linear duration-300" 
       x-transition:enter-start="opacity-0" 
       x-transition:enter-end="opacity-100" 
       x-transition:leave="transition-opacity ease-linear duration-300" 
       x-transition:leave-start="opacity-100" 
       x-transition:leave-end="opacity-0">
    
    <!-- Backdrop -->
    <div class="fixed inset-0 bg-black bg-opacity-50" @click="mobileMenuOpen = false"></div>

    <!-- Panel -->
    <div class="relative bg-white w-3/4 max-w-sm h-full shadow-xl flex flex-col p-6"
         x-transition:enter="transition ease-in-out duration-300 transform" 
         x-transition:enter-start="-translate-x-full" 
         x-transition:enter-end="translate-x-0" 
         x-transition:leave="transition ease-in-out duration-300 transform" 
         x-transition:leave-start="translate-x-0" 
         x-transition:leave-end="-translate-x-full">
         
         <div class="flex justify-between items-center mb-8">
            <span class="font-bold text-xl uppercase">Menu</span>
            <button @click="mobileMenuOpen = false">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
            </button>
         </div>

         <nav class="flex flex-col gap-4">
            {% for link in linklists.main-menu.links %}
              <a href="{{ link.url }}" class="text-lg font-bold uppercase border-b border-gray-100 pb-2">{{ link.title }}</a>
            {% endfor %}
         </nav>
    </div>
  </div>
</header>
